\chapter{Reducibility of {\it p}-torsion of the Frey curve}\label{ch_freyreduction}

\section{Overview}

In chapter~\ref{ch_reductions} we reduced FLT, modulo a hard theorem from the 1970s,
to Theorem~\ref{Wiles_Frey}, the assertion that $p$-torsion in the Frey
curve is reducible. In this chapter we deduce this assertion from three more complex claims
about ``hardly ramified'' Galois representations. It is relatively straightforward
to reduce one of these three claims to a result of Fontaine proved in the 1980s in his
paper on the nonexistence of nontrivial abelian schemes over $\Z$. The other two
claims lie deeper, and their proofs use techniques initially developed by Wiles in
the 1990s.

\section{Hardly ramified representations}

Let $(a,b,c,p)$ be a Frey package (so in particular $p\geq5$ is prime and $a^p+b^p=c^p$),
let $E$ be the corresponding Frey curve over $\Q$, and let $\rho:\GQ\to\Aut(E(\Qbar)[p])$
be the 2-dimensional Galois representation on the $p$-torsion of~$E$. Recall that our goal
is to prove that $\rho$ is reducible.

What we need to leverage is the fact that $\rho$ has very little ramification. To give
a toy example before we start: if $K$ is a number field (i.e., a finite extension of $\Q$)
and if the extension $K/\Q$ is unramified at all primes, then an old theorem of
Minkowski tells us that $K=\Q$. We want to prove a theorem in a similar vein, namely
that if a 2-dimensional mod $p$ Galois representation is ``hardly ramified'', then it is reducible.
Below, we give a precise
definition of what it means for a continuous 2-dimensional representation $\GQ\to\GL_2(R)$
to be hardly ramified. Before we do that, we need to say precisely which topological rings~$R$
we will allow. We say that a topological ring is emph{pro-Artinian} if it is a projective
limit of Artin local rings each equipped with the discrete topology, and if it has the
projective limit topology. We are only concerned with local pro-Artinian rings with finite
residue field; such things can be checked to be the same thing as topological
local rings with finite residue field whose underlying topological space is profinite,
and such that additive translates of open ideals form a basis for the topology.
Let us call such rings ``coefficient rings'' for now.

\begin{remark} We make some remarks to orient the reader.
  \begin{itemize}
    \item Any complete local Noetherian ring with finite residue field is a coefficient ring,
      if the ring is equipped with the $\m$-adic topology where $\m$ is the maximal ideal.
      In this case, all powers of $\m$ are open.
    \item In particular finite fields, and integer rings of finite extensions
      of $\Q_p$, are coefficient rings.
    \item If $R$ is a coefficient ring then $R$ is isomorphic to the projective limit
      of the finite rings $R/I$ as $I$ runs over the open ideals of~$R$.
    \item A non-Noetherian example of a coefficient ring is the projective limit over $n$ of
the rings $\Z/p\Z[\varepsilon_1,\ldots,\varepsilon_n]/(\forall i,j,\varepsilon_i\varepsilon_j=0)$;
these rings are convenient to include as coefficient rings for technical reasons; they make
representability theorems easier.
    \item The category of coefficient rings is equivalent to the pro-category of the
      category of finite local rings.
    \item A coefficient ring is pseudocompact in the sense of Grothendieck. A pseudocompact
      local ring is however a more general concept as such a thing may have an infinite
      residue field and would thus not be profinite.
    \item If $R$ is a coefficient ring with residue field of characteristic $\ell$,
  then there is a unique continuous map $\Z_\ell\to R$. Indeed, it suffices to prove that there
  is a unique continuous map $\Z_\ell\to R/I$ for each
  open ideal~$I$, but $R/I$ is a finite local ring with residue field of characteristic $\ell$.
  $R/I$ is hence Artinian, so some power of the maximal ideal is zero by Nakayama. This means
  that $\ell^N=0$ for some sufficiently large $N$, and hence $R/I$ is a $\Z/\ell^N\Z$-algebra
  and thus admits admits a unique map from $\Z_\ell$.
    \item It will be more convenient to fix once and for all the integer $\mathcal{O}$ in a
  finite extension of $\Q_\ell$ and consider ``coefficient $\mathcal{O}$-algebras'', namely
  coefficient rings~$R$ equipped with a continuous map $\mathcal{O}\to R$ which is a local
  homomorphism inducing an isomorphism on residue fields.
  \end{itemize}
\end{remark}

Because a coefficient ring~$R$ with residue field of characteristic $\ell$ is naturally
a $\Z_\ell$-algebra, we can talk about the $\ell$-adic cyclotomic character $\GQ\to R^\times$.
We are now ready to define hardly ramified representations.

\begin{definition}
  \lean{GaloisRepresentation.IsHardlyRamified}
  \label{hardly_ramified}
  \leanok
  Let $R$ be a coefficient ring with finite residue field of characteristic $\ell\geq3$.
  Let $V$ be a finite free $R$-module of rank~2, equipped with the product topology. A
  continuous representation $\rho: \GQ\to \GL_R(V)$ is said to be \emph{hardly ramified} if it
  satisfies the following four conditions:
  \begin{enumerate}
  \item $\det(\rho):\GQ\to R^\times$ is the cyclotomic character;
  \item $\rho$ is unramified outside $2\ell$;
  \item The restriction of $\rho$ to $\Gal(\Qbar_2/\Q_2)$ is reducible (more precisely,
  there is a short exact sequence $0\to R\to V\to R\to 0$ which is stable
  under the action of $\Gal(\Qbar_2/\Q_2)$) and the Galois action on the 1-dimensional
  quotient is an unramified representation of $\Gal(\Qbar_2/\Q_2)$ whose square is trivial;
  \item The restriction of $\rho$ to $\GQl$ is flat, by which we mean that for all open
  ideals $I$ of $R$, the (finite image) representation $\rho$ mod $I:\GQl\to \GL_{R/I}(V/I)$
  comes from a finite flat group scheme.
  \end{enumerate}
\end{definition}

A well-known result, which basically goes back to Frey, is the following:

\begin{theorem}
  \lean{FreyCurve.torsion_isHardlyRamified}
  \label{Frey_curve_hardly_ramified}
  \uses{hardly_ramified}
  \leanok
  The $\ell$-torsion $\rho:\GQ\to\GL_2(\Z/\ell\Z)$ in the Frey curve associated to a Frey
  package $(a,b,c,\ell)$ is hardly ramified.
\end{theorem}
\begin{proof}
  This was well-known in the 1980s. A proof sketch is as follows.
  First note that $\ell\geq5>3$ by definition of a Frey package. Let $\rho$
  denote the Galois representation on the $\ell$-torsion of the Frey curve.
  The fact that $\rho$ is 2-dimensional is~Corollary
  III.6.4(b) of~\cite{silverman1}, and the fact that its determinant is
  cyclotomic is Proposition~III.8.3 of the same reference. These results hold for elliptic curves
  in general. The remaining claims are specific to the Frey curve and lie
  deeper. The fact that $\rho$ is unramified outside $2\ell$ is a consequence
  of (4.1.12) and (4.1.13) of~\cite{serreconj}. The fact that $\rho$ at 2
  has an unramified 1-dimensional quotient of order at most 2 follows from
  the fact that the Frey curve is semistable at~2 (see (4.1.5) of~\cite{serreconj})
  and the theory of the Tate curve. Finally, the claim that $\rho$ is flat at $\ell$
  is Proposition~5 and (4.1.13) of~\cite{serreconj}.
\end{proof}


Note that irreducibility and absolute irreducibility for hardly ramified mod $\ell$ representations
are the same, because our assumptions that $\ell\geq3$
and that the determinant is cyclotomic imply that the image of complex conjugation
has distinct eigenvalues defined over the ground field.

The key theorem about hardly ramified representations is the following.

\begin{theorem}
  \lean{FreyCurve.torsion_not_isIrreducible}
  \label{hardly_ramified_reducible}
  \leanok
  If $\ell\geq 3$ is a prime and $\rho:\GQ\to\GL_2(\Z/\ell\Z)$ is hardly ramified,
  then $\rho$ is reducible.
\end{theorem}

Note that this (deep) claim is a consequence of Serre's conjecture~\cite{serreconj},
now a theorem of Khare and Wintenberger~\cite{kwII}, and indeed we shall use
methods introduced by Khare and Wintenberger to prove this special case of
Serre's conjecture. Given this result, we can deduce Theorem~\ref{Wiles_Frey}
(which we restate here) easily:

\begin{theorem}
  \label{Wiles_Frey_again}
  \lean{Wiles_Frey}
  \leanok
  If $\overline{\rho}$ is the mod $p$ Galois representation associated to a Frey package $(a,b,c,p)$ then
  $\overline{\rho}$ is reducible.
\end{theorem}
\begin{proof}
  \uses{Frey_curve_hardly_ramified,hardly_ramified_reducible}
  Indeed, $\rho$ is hardly ramified by theorem~\ref{Frey_curve_hardly_ramified}
  and thus reducible by theorem~\ref{hardly_ramified_reducible}.
\end{proof}

Our job of reducing FLT to theorems of the 1980s is hence reduced to proving
Theorem~\ref{hardly_ramified_reducible}.

\subsection{Hardly ramified mod $p$ representations are reducible}

In this section we will state three theorems, from which Theorem~\ref{hardly_ramified_reducible}
easily follows.

Firstly, we claim that
an irreducible hardly ramified mod $\ell$ representation lifts to an $\ell$-adic representation.

\begin{theorem}
  \lean{GaloisRepresentation.IsHardlyRamified.lifts}
  \label{hardly_ramified_lifts}
  \uses{hardly_ramified}
  \leanok
  If $\ell\geq3$ is prime and $\overline{\rho}:\GQ\to\GL_2(\Z/\ell\Z)$
  is hardly ramified and irreducible, then there exists a finite extension~$K$ of $\Q_\ell$
  with integer ring~$\calO$ and maximal ideal $\mathfrak{m}$
  and a hardly ramified representation
  $\rho:\GQ\to\GL_2(\calO)$ whose reduction modulo~$\m$ is isomorphic to $\rho$.
\end{theorem}
\begin{proof}
  Omitted for now {\bf TODO}
\end{proof}

Next we claim that a hardly ramified $\ell$-adic representation ``spreads out'' to a compatible
family of hardly ramified $q$-adic representations for all odd primes $q$ (note that we have
not made a definition of a hardly ramified 2-adic representation).

\begin{theorem}
  \lean{GaloisRepresentation.IsHardlyRamified.mem_isCompatible}
  \label{hardly_ramified_spreads_out}
  \uses{hardly_ramified}
  \leanok
  If $\ell\geq3$ is prime, $K$ is a finite extension of $\Q_\ell$
  with integers $\calO$ and if $\rho:\GQ\to\GL_2(\calO)$ is a hardly ramified representation
  whose reduction is irreducible,
  then there exists a number field $M$ and, for each finite place $\mu$ of $M$
  of characteristic prime to 2, with completion $M_\mu$ having integer ring $R_\mu$,
  a hardly ramified semisimple representation $\rho_\mu:\GQ\to\GL_2(R_\mu)$ (by which we
  mean the generic fibre is semisimple), with the following properties:
  \begin{itemize}
    \item There is some $\lambda\mid\ell$ of $M$ such that $\rho_\lambda\cong\rho$,
      the isomorphism happening over some appropriate local field containing a copy
      of $M_\lambda$ and a copy of~$K$;
    \item If $\mu_1$ and $\mu_2$ are two finite places of $M$ with odd residue characteristics $m_1$
      and $m_2$, and if $p\nmid 2m_1m_2$ is prime, then $\rho_{\mu_1}$ and $\rho_{\mu_2}$
      are both unramified at~$p$ and the characteristic polynomials $\rho_{\mu_1}(\Frob_p)$
      and $\rho_{\mu_2}(\Frob_p)$ lie in $M[X]$ and are equal.
  \end{itemize}
\end{theorem}
\begin{proof}
  Omitted for now {\bf TODO}
\end{proof}

In particular, we can ``move'' from an irreducible hardly ramified mod $\ell$ representation
to a hardly ramified 3-adic representation, and hence to a hardly ramified mod 3 representation.

However, we can essentially completely classify the hardly ramified mod 3 Galois representations:

\begin{theorem}
  \lean{GaloisRepresentation.IsHardlyRamified.mod_three}
  \label{hardly_ramified_mod3_reducible}
  \uses{hardly_ramified}
  \leanok
  Suppose $k$ is a finite field of characteristic 3, and suppose
  $\overline{rho}:\GQ\to\GL_2(k)$ is hardly ramified. Then $\overline{\rho}$ is an extension
  of the cyclotomic character by the trivial representation.
\end{theorem}
\begin{proof}
  Omitted for now. {\bf TODO}
\end{proof}

And we can use this to essentially completely classify the hardly ramified 3-adic Galois
representations:

\begin{theorem}
  \lean{GaloisRepresentation.IsHardlyRamified.three_adic}
  \label{hardly_ramified_3adic_reducible}
  \uses{hardly_ramified, hardly_ramified_mod3_reducible}
  \leanok
  Suppose $L/\Q_3$ is a finite extension, with integer ring $\calO_L$, and suppose
  $\rho_3:\GQ\to\GL_2(\calO_L)$ is hardly ramified. Then (considered as a representation
  to $\GL_2(L)$) $\rho_3^{ss}=1\oplus\chi_3$
  where $1$ is the trivial character and $\chi_3$ is the 3-adic cyclotomic character.
\end{theorem}
\begin{proof}
  Omitted for now {\bf TODO}
\end{proof}

Theorem~\ref{hardly_ramified_reducible} (if $\ell\geq 3$ is a prime and
$\overline{\rho}:\GQ\to\GL_2(\Z/\ell\Z)$ is hardly ramified,
then $\overline{\rho}$ is reducible) is an easy consequence of these theorems,
as we now show.

\begin{proof}
  \proves{hardly_ramified_reducible}
  \uses{hardly_ramified_lifts,
    hardly_ramified_spreads_out,hardly_ramified_3adic_reducible}
  Assume for a contradiction that $\overline{\rho}$ is irreducible. By theorem~\ref{hardly_ramified_lifts},
  $\overline{\rho}$ lifts to a hardly ramified $\ell$-adic reprepresentation $\rho$. By
  theorem~\ref{hardly_ramified_spreads_out}, $\rho$ is part of a compatible family of
  $q$-adic Galois representations. By theorem~\ref{hardly_ramified_3adic_reducible},
  any 3-adic member $\rho_3$ of this family has semisimplification $1\oplus\chi_3$ and in particular
  for $p\nmid 6$ we have that the characteristic polynomial of $\rho_3(\Frob_p)=(X-p)(X-1).$
  By compatibility of the family we deduce that for $p\nmid 6\ell$ the characteristic
  polynomial of $\rho(\Frob_p)$ is $(X-p)(X-1)$, and thus the characteristic polynomial
  of $\overline{\rho}(\Frob_p)$ is $(X-p)(X-1)$. By the Cebotarev density theorem,
  $\overline{\rho}$ and $1\oplus\chi$ have the same characteristic polynomials everywhere
  (here $\chi$ is the mod $\ell$ cyclotomic character). Thus by the Brauer-Nesbitt theorem,
  $\overline{\rho}$ is reducible, the contradiction we seek.
\end{proof}

What remains then (modulo several results which were known in the 1980s),
is to prove the three theorems~\ref{hardly_ramified_lifts},
\ref{hardly_ramified_spreads_out} and~\ref{hardly_ramified_3adic_reducible}.
By far the easiest is theorem~\ref{hardly_ramified_3adic_reducible}; this follows
from old estimates of Fontaine (ultimately relying on bounds for root discriminants due to
Odlyzko and Poitou), originally developed to prove that there was no
nontrivial abelian scheme over $\Z.$ The other two theorems are deeper, and both use
modern variants of Wiles' $R=T$ machinery.

We have not yet written any more LaTeX on how to proceed further; the rest of
this blueprint should be considered as more unfocussed thoughts.
